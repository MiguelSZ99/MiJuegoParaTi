<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Panel de Miguel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
             background: #111; color: #fff; padding: 24px;">

  <h1>Panel de Miguel ğŸ˜</h1>
  <p style="opacity:0.8;">AquÃ­ ves lo que Ketzally te escribiÃ³ y mandas tu respuesta real.</p>

  <div style="margin-top:16px; padding:12px; border-radius:12px; background:#222;">
    <div style="font-size:0.8rem; text-transform:uppercase; opacity:0.7;">Mensaje de Ketzally ğŸ’œ</div>
    <div style="margin-top:4px;" id="preguntaTexto">
      {% if pregunta_ketzally %}
        {{ pregunta_ketzally }}
      {% else %}
        AÃºn no te ha escrito nada ğŸ˜…
      {% endif %}
    </div>
  </div>

  <form method="post" action="/miguel" style="margin-top:18px;">
    <label for="respuesta" style="display:block; margin-bottom:6px;">Tu respuesta (Miguel):</label>
    <textarea id="respuesta" name="respuesta"
      style="width:100%; max-width:480px; min-height:80px; border-radius:10px; padding:10px; border:none;"></textarea>
    <div style="margin-top:10px;">
      <button type="submit"
        style="border:none; border-radius:999px; padding:10px 18px; font-weight:600;
        background:#ff9bd2; color:#2a1430; cursor:pointer;">
        Guardar respuesta ğŸ’Œ
      </button>
    </div>
  </form>

  <div style="margin-top:18px; padding:12px; border-radius:12px; background:#223;">
    <div style="font-size:0.8rem; text-transform:uppercase; opacity:0.7;">Respuesta actual que ve Ketzally</div>
    <div style="margin-top:4px;" id="respuestaTexto">
      {% if respuesta_pregunta %}
        {{ respuesta_pregunta }}
      {% else %}
        TodavÃ­a no has respondido este mensaje.
      {% endif %}
    </div>
  </div>

  <p style="margin-top:24px;">
    <a href="/" style="color:#ff9bd2; text-decoration:none;">â¬… Ver la app como la ve ella</a>
  </p>

<script>
function updatePanel() {
    fetch("/estado")
    .then(r => r.json())
    .then(data => {
        document.getElementById("preguntaTexto").innerText =
          data.pregunta || "AÃºn no te ha escrito nada ğŸ˜…";

        document.getElementById("respuestaTexto").innerText =
          data.respuesta || "TodavÃ­a no has respondido este mensaje.";
    }).catch(() => {});
}

setInterval(updatePanel, 2000);
updatePanel();
</script>

</body>
</html>
